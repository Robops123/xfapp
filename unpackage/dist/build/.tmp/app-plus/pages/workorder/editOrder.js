(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/workorder/editOrder"],{"076d":function(e,t,n){"use strict";var a,i=function(){var e=this,t=e.$createElement;e._self._c},o=[];n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return a})},2382:function(e,t,n){"use strict";var a=n("8275"),i=n.n(a);i.a},"5bfe":function(e,t,n){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=u(n("a34a")),o=u(n("f40e")),r=u(n("d429"));function u(e){return e&&e.__esModule?e:{default:e}}function s(e,t,n,a,i,o,r){try{var u=e[o](r),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(a,i)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(a,i){var o=e.apply(t,n);function r(e){s(o,a,i,r,u,"next",e)}function u(e){s(o,a,i,r,u,"throw",e)}r(void 0)})}}var d=function(){return n.e("components/uni-icon/uni-icon").then(n.bind(null,"256b"))},l={components:{uniIcon:d},data:function(){return{order_no:"",select_item:"",price_type:"common_price",product_name:"",product_image1:"",price:0,sourceType:[["camera"],["album"],["camera","album"]],price1:0,price2:0,tempImgList:[],price3:0,activeIndex:-1,uploading:!1,desc:"",index:0,type:null,items:[],indexSex:0,arraySex:[{sexname:"男"},{sexname:"女"}],indexOld:40,seller_id:0,consultant:"",consultant_id:0,consultant_phone:"",buyer:"",buyer_phone:"",buyer_collector:"",maintainName:"",remark:"",uploaded:0,orderCode:"",userName:"",maintainLocation:"",assignTime:"",imageList:[],sourceTypeIndex:2,sizeTypeIndex:2,countIndex:8,count:[1,2,3,4,5,6,7,8,9],form:{tenantId:e.getStorageSync("tenantId"),orderId:"",repairUser:"",endTime:"",remark:"",filePath:""}}},onLoad:function(e){var t=JSON.parse(e.params),n=this;if(this.form.orderId=t.orderId,this.form.repairUser=t.maintainName,this.form.endTime=t.doneTime,this.form.remark=t.feedback,this.type=e.type,this.remark=t.remark,this.maintainName=t.maintainName,this.orderCode=t.orderCode,this.userName=t.userName,this.maintainLocation=t.maintainLocation,this.assignTime=t.assignTime,null!=t.filePath){var a=[];a=t.filePath.split(","),a.forEach(function(e){""!=e&&n.imageList.push(t.picServer+e)})}},methods:{submit:function(){r.default.showLoading(),console.log(a(this.form," at pages\\workorder\\editOrder.vue:212")),o.default.apiPost("/workOrder/handle",this.form).then(function(t){console.log(a(t," at pages\\workorder\\editOrder.vue:214")),200==t.code?(r.default.showToast("提交成功"),e.$emit("handleSubmit"),setTimeout(function(){e.navigateBack({delta:1})},1e3)):r.default.showToast("提交失败"),r.default.hideLoading()}).catch(function(e){r.default.hideLoading(),r.default.showToast("网络出错")})},chooseImage:function(){var t=c(i.default.mark(function t(){var n,a;return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(n=this,9!==this.imageList.length){t.next=7;break}return t.next=4,this.isFullImg();case 4:if(a=t.sent,a){t.next=7;break}return t.abrupt("return");case 7:e.chooseImage({sourceType:this.sourceType[this.sourceTypeIndex],sizeType:["compressed"],count:this.imageList.length+this.count[this.countIndex]>9?9-this.imageList.length:this.count[this.countIndex],success:function(e){n.compressImage(e.tempFilePaths)}});case 8:case"end":return t.stop()}},t,this)}));function n(){return t.apply(this,arguments)}return n}(),compressImage:function(e){var t=this;t.uploading=!0,e.forEach(function(n,a){var i=n.split("/"),o=i[i.length-1];plus.zip.compressImage({src:n,dst:"_doc/"+o,quality:10},function(n){t.uploadImg(n.target,e.length)},function(e){r.default.showToast("图片压缩失败")})})},deleteimg:function(e){this.imageList.splice(e,1)},uploadImg:function(t,n){var a=this.imageList.length,i=this;0!=a&&(i.uploading=!0,e.uploadFile({url:o.default.baseURL+"/hazard/upload",filePath:t,name:"file",header:{Accept:"application/json",Authorization:"Bearer "+e.getStorageSync("Authorization")},success:function(e){var a=JSON.parse(e.data);200==a.code?(i.uploaded++,i.tempImgList.push(t),i.uploaded<n?i.form.filePath+=a.data+",":i.uploaded==n&&(i.imageList=i.imageList.concat(i.tempImgList),i.form.filePath+=a.data,i.uploading=!1)):(r.default.showToast("图片上传失败"),i.uploading=!1)},fail:function(e){i.uploading=!1,r.default.showToast("请检查网络连接")}}))}}};t.default=l}).call(this,n("6e42")["default"],n("0de9")["default"])},8275:function(e,t,n){},"98ea":function(e,t,n){"use strict";n.r(t);var a=n("5bfe"),i=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,function(){return a[e]})}(o);t["default"]=i.a},cf5b:function(e,t,n){"use strict";n.r(t);var a=n("076d"),i=n("98ea");for(var o in i)"default"!==o&&function(e){n.d(t,e,function(){return i[e]})}(o);n("2382");var r,u=n("f0c5"),s=Object(u["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],r);t["default"]=s.exports},d650:function(e,t,n){"use strict";(function(e){n("d53d"),n("921b");a(n("66fd"));var t=a(n("cf5b"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])}},[["d650","common/runtime","common/vendor"]]]);